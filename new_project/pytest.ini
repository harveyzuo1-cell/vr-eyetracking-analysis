[pytest]
# Pytest配置文件
# Pytest Configuration File

# 测试文件和目录模式
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# 测试目录
testpaths = tests

# 最小版本要求
minversion = 7.0

# 命令行选项
addopts =
    # 显示详细输出
    -v
    # 显示本地变量
    --showlocals
    # 显示测试覆盖率
    --cov=src
    --cov=config
    # 覆盖率报告格式
    --cov-report=html
    --cov-report=term-missing
    # 失败时显示额外信息
    --tb=short
    # 严格模式
    --strict-markers
    # 警告处理
    -W ignore::DeprecationWarning
    # 并行测试(可选,需要pytest-xdist)
    # -n auto

# 自定义标记
markers =
    unit: 单元测试
    integration: 集成测试
    slow: 慢速测试(>1s)
    api: API测试
    service: 服务层测试
    module00: Module00相关测试
    module01: Module01相关测试
    moduleex: ModuleEX相关测试
    task_config: TaskConfigService测试
    roi: ROI相关测试

# 覆盖率配置
[coverage:run]
source = src,config
omit =
    */tests/*
    */test_*
    */__pycache__/*
    */venv/*
    */env/*

[coverage:report]
# 最低覆盖率要求
fail_under = 70
# 精度
precision = 2
# 跳过覆盖的文件
skip_covered = False
# 显示缺失的行
show_missing = True

[coverage:html]
directory = htmlcov
